import{a as k}from"./chunk-5ZKMY5GM.js";import{a as ge}from"./chunk-II6FOY3U.js";import{a as E}from"./chunk-CUB5A5UJ.js";import{A as me,B as de,D as pe,a as ae,j as se,m as le,n as ce,v as ue}from"./chunk-6UAI7CFH.js";import{C as re,f as $,m as ee,o as te,s as ne,x as ie,z as oe}from"./chunk-MU56VQVL.js";import{Ea as W,Gb as H,Ha as z,I as c,J as P,L as V,Ma as j,O,Ob as G,Pb as J,Q as x,Qb as K,Ua as A,W as n,X as i,Xa as B,Y as g,Yb as X,aa as v,ba as _,bc as Y,ca as u,cb as q,cc as Z,ia as F,ja as T,ka as U,ma as a,na as f,oa as N,p as D,pa as S,qa as w,r as M,ra as y,ta as L,vb as Q,y as m,z as d,zb as R}from"./chunk-IK3SDQQI.js";import"./chunk-KQYAU5ZY.js";import"./chunk-7KGURMOZ.js";import"./chunk-ZRAG276G.js";import"./chunk-BYYCXTI5.js";import"./chunk-TTTB7IPG.js";import"./chunk-CHHPJ5YN.js";import"./chunk-LZHEG2YN.js";import"./chunk-4U6PRYVA.js";import"./chunk-OAACOBQM.js";import"./chunk-JWIEPCRG.js";import"./chunk-C5RQ2IC2.js";import"./chunk-D4VGNZLR.js";import"./chunk-JHLW7V75.js";import"./chunk-SV7S5NYR.js";import{g as h}from"./chunk-OLRFWS6T.js";var _e=(()=>{let l=class l{constructor(t,e,o,p){this.router=t,this.authService=e,this.auth=o,this.firestore=p}checkSessionService(){return h(this,null,function*(){try{let t=localStorage.getItem("userData");return t?(this.userData=JSON.parse(t),console.log(this.userData),this.userData):(this.userData="",console.log("Aucune donn\xE9e utilisateur trouv\xE9e dans localStorage."),null)}catch(t){return console.error("Erreur lors de la v\xE9rification de la session:",t),null}})}getUserFromFirestore(){return h(this,null,function*(){try{if(localStorage.getItem("userid")){let e=localStorage.getItem("userid");console.log(e);let o=ne(this.firestore,"users"),p=oe(o,re("userid","==",e)),b=yield ie(p),C=null;if(b.empty)return console.log("Aucun utilisateur trouv\xE9 avec cet UID."),C=!0,C;{let I=b.docs[0].data();return console.log(I),C=null,I}}else return console.log("Aucun utilisateur authentifi\xE9."),null}catch(t){return console.error("Erreur lors de la r\xE9cup\xE9ration de l'utilisateur dans Firestore:",t),null}})}signoutService(){return h(this,null,function*(){try{yield ee(this.auth),localStorage.removeItem("userid"),this.router.navigate(["/tabs/accueil"]).then(()=>{setTimeout(()=>{window.location.reload()},100)}),console.log("User signed out")}catch(t){console.error("Logout error:",t)}})}};l.\u0275fac=function(e){return new(e||l)(M(j),M(k),M($),M(te))},l.\u0275prov=D({token:l,factory:l.\u0275fac,providedIn:"root"});let s=l;return s})();var be=["editModal"],Ce=()=>[.5,.8,.85];function Me(s,l){if(s&1){let r=v();n(0,"ion-button",25),_("click",function(){m(r);let e=u(2);return d(e.openUpdateLink())}),a(1," Mis \xE0 jours "),i()}}function Oe(s,l){if(s&1&&(n(0,"div",12),O(1,Me,2,0,"ion-button",24),i()),s&2){let r=u();c(),x("ngIf",r.update)}}function ve(s,l){if(s&1){let r=v();n(0,"ion-button",34),_("click",function(){m(r);let e=u(2);return d(e.updateUser(e.userid))}),a(1,"Modifier"),i()}if(s&2){let r=u(2);x("disabled",r.userid?"false":"true")}}function Se(s,l){if(s&1){let r=v();n(0,"ion-content",26)(1,"div",27)(2,"h2"),a(3,"Get Started"),i(),n(4,"ion-toast",28),_("didDismiss",function(){m(r);let e=u();return d(e.setOpen(!1))}),i(),n(5,"ion-item",17)(6,"ion-input",29),_("ionFocus",function(){m(r);let e=u();return d(e.expandModal())}),y("ngModelChange",function(e){m(r);let o=u();return w(o.name,e)||(o.name=e),d(e)}),i()(),n(7,"ion-item",17)(8,"ion-input",30),_("ionFocus",function(){m(r);let e=u();return d(e.expandModal())}),y("ngModelChange",function(e){m(r);let o=u();return w(o.numero,e)||(o.numero=e),d(e)}),i()(),n(9,"ion-item",17)(10,"ion-input",31),_("ionFocus",function(){m(r);let e=u();return d(e.expandModal())}),y("ngModelChange",function(e){m(r);let o=u();return w(o.p_email,e)||(o.p_email=e),d(e)}),i()(),n(11,"div",32),O(12,ve,2,1,"ion-button",33),i()()()}if(s&2){let r=u();c(4),x("isOpen",r.isToastOpen)("duration",3e3),c(2),S("ngModel",r.name),c(2),S("ngModel",r.numero),c(2),S("ngModel",r.p_email),c(2),x("ngIf",r.userid)}}var ze=(()=>{let l=class l{constructor(t,e,o,p,b,C){this.authService=t,this.userService=e,this.sessionService=o,this.projectService=p,this.updateService=b,this.router=C,this.isToastOpen=!1,this.userid=localStorage.getItem("userid"),this.name="",this.totalProjets=0,this.totalProjetsEnCours=0,this.totalProjetsFini=0,this.email="",this.p_email="",this.poste="",ae({createOutline:ce,mailOutline:me,callOutline:se,peopleOutline:de,chevronForwardOutline:le,personOutline:pe,logOut:ue})}ngOnInit(){this.getUpdate(),this.userid&&(this.loadUser(this.userid),this.countProjects(this.userid),this.countProjectsProgress(this.userid),this.countProjectsDone(this.userid))}checkSession(){return h(this,null,function*(){let t=yield this.sessionService.getUserFromFirestore();t?(console.log("Donn\xE9es utilisateur r\xE9cup\xE9r\xE9es:",t),this.userData=t,this.name=this.userData.name||"",this.numero=this.userData.numero||0,this.email=this.userData.email,this.p_email=this.userData.p_email,this.poste=this.userData.poste,this.userid=this.userData.userid):this.router.navigate(["/compte"])})}loadUser(t){this.userService.getUserById(t).subscribe({next:e=>{e?(this.userData=e,this.name=this.userData.name||"",this.numero=this.userData.numero||0,this.email=this.userData.email,this.p_email=this.userData.p_email,this.poste=this.userData.poste,this.userid=this.userData.userid,console.log("Utilisateur charg\xE9 :",e)):console.warn("Aucun utilisateur trouv\xE9 avec l'ID:",t)},error:e=>{console.error("Erreur lors du chargement de l'utilisateur :",e)}})}updateUser(t){return h(this,null,function*(){try{yield this.authService.updateUserService(this.name,this.p_email,this.numero,t),console.log("\u2705 Mise \xE0 jour r\xE9ussie"),this.isToastOpen=!0}catch(e){console.error("\u274C Erreur lors de la mise \xE0 jour de l'utilisateur :",e)}})}getUpdate(){this.updateService.getUpdateApp().subscribe(t=>{this.update=t})}setOpen(t){this.isToastOpen=t}countProjects(t){this.projectService.countProjects(t).subscribe(e=>{console.log("Nombre de projets pour ce user :",e),this.totalProjets=e})}countProjectsProgress(t){this.projectService.countProgressProjects(t).subscribe(e=>{console.log("Nombre de projets en cours pour ce user :",e),this.totalProjetsEnCours=e})}countProjectsDone(t){this.projectService.countProjectsDone(t).subscribe(e=>{console.log("Nombre de projets Termin\xE9 pour ce user :",e),this.totalProjetsFini=e})}openUpdateLink(){var t;(t=this.update)!=null&&t.lien&&window.open(this.update.lien,"_blank")}signout(){this.authService.signoutService()}login(){this.router.navigate(["/client/login"])}goHome(){this.router.navigate(["/home"])}expandModal(){var t;(t=this.editModal)==null||t.setCurrentBreakpoint(.8)}};l.\u0275fac=function(e){return new(e||l)(P(k),P(ge),P(_e),P(E),P(E),P(j))},l.\u0275cmp=V({type:l,selectors:[["app-profile"]],viewQuery:function(e,o){if(e&1&&F(be,5),e&2){let p;T(p=U())&&(o.editModal=p.first)}},decls:65,vars:12,consts:[["editModal",""],[1,"go-back"],["fill","clear",1,"left-button",3,"click"],["src","assets/ionicons/arrow-back.svg","alt",""],["expand","block","fill","clear","id","edit",1,"right-button"],["slot","start","name","create-outline"],[1,"top-content"],[1,"profile-card","ion-text-center"],[1,"profile-image"],["src","assets/img/profile.jpg","alt","Profile Photo"],[1,"name"],[1,"stats"],[1,"bottom-button"],["expand","block","fill","outline","color","danger",3,"click"],["slot","start","name","log-out"],["class","bottom-button",4,"ngIf"],[1,"bottom-content"],["lines","none"],["name","mail-outline","slot","start","color","primary"],[1,"label"],["name","call-outline","slot","start","color","primary"],["name","people-outline","slot","start","color","primary"],["name","chevron-forward-outline","slot","end"],["trigger","edit",3,"initialBreakpoint","breakpoints"],["expand","block","fill","outline","color","success",3,"click",4,"ngIf"],["expand","block","fill","outline","color","success",3,"click"],[1,"modal"],[1,"container"],["message","Modifi\xE9 avec succes","position","middle",3,"didDismiss","isOpen","duration"],["label","Full Name","labelPlacement","stacked","type","text","placeholder","Enter Full Name",3,"ionFocus","ngModelChange","ngModel"],["label","Numero","labelPlacement","stacked","type","number","placeholder","Enter Numero",3,"ionFocus","ngModelChange","ngModel"],["label","Email Personnelle","labelPlacement","stacked","type","text","placeholder","Enter Email",3,"ionFocus","ngModelChange","ngModel"],[1,"del-button","ion-text-center"],["color","danger",3,"disabled","click",4,"ngIf"],["color","danger",3,"click","disabled"]],template:function(e,o){if(e&1){let p=v();n(0,"ion-content")(1,"div",1)(2,"ion-button",2),_("click",function(){return m(p),d(o.goHome())}),g(3,"img",3),i(),n(4,"ion-button",4),g(5,"ion-icon",5),a(6," edite "),i()(),n(7,"div",6)(8,"div",7)(9,"div",8),g(10,"img",9),i(),n(11,"h2",10),a(12),i(),n(13,"div",11)(14,"div")(15,"h3"),a(16),i(),n(17,"p"),a(18,"Projets"),i()(),n(19,"div")(20,"h3"),a(21),i(),n(22,"p"),a(23,"Projets En Cours"),i()(),n(24,"div")(25,"h3"),a(26),i(),n(27,"p"),a(28,"Projets Termin\xE9s"),i()()()(),n(29,"div",12)(30,"ion-button",13),_("click",function(){return m(p),d(o.signout())}),g(31,"ion-icon",14),a(32," Log Out "),i()(),O(33,Oe,2,1,"div",15),i(),n(34,"div",16)(35,"ion-list",17)(36,"ion-item"),g(37,"ion-icon",18),n(38,"ion-label")(39,"p",19),a(40,"Official"),i(),n(41,"h2"),a(42),i()()(),n(43,"ion-item"),g(44,"ion-icon",18),n(45,"ion-label")(46,"p",19),a(47,"Personal"),i(),n(48,"h2"),a(49),i()()(),n(50,"ion-item"),g(51,"ion-icon",20),n(52,"ion-label")(53,"p",19),a(54,"Numero"),i(),n(55,"h2"),a(56),i()()(),n(57,"ion-item"),g(58,"ion-icon",21),n(59,"ion-label"),a(60),i(),g(61,"ion-icon",22),i()()(),n(62,"ion-modal",23,0),O(64,Se,13,6,"ng-template"),i()()}e&2&&(c(12),f(o.name),c(4),f(o.totalProjets),c(5),f(o.totalProjetsEnCours),c(5),f(o.totalProjetsFini),c(7),x("ngIf",o.update),c(9),f(o.email),c(7),f(o.p_email),c(7),N("(221) ",o.numero,""),c(4),f(o.poste),c(2),x("initialBreakpoint",.5)("breakpoints",L(11,Ce)))},dependencies:[H,J,G,Y,Q,X,R,Z,K,z,W,q,A,B],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--overflow: hidden;--background: #f5f5f5}ion-content[_ngcontent-%COMP%]   .go-back[_ngcontent-%COMP%]{position:fixed;top:40px;left:20px;right:20px;z-index:99;display:flex;align-items:center;justify-content:space-between;gap:10px}ion-content[_ngcontent-%COMP%]   .go-back[_ngcontent-%COMP%]   .left-button[_ngcontent-%COMP%]{background:none;border-radius:25px}ion-content[_ngcontent-%COMP%]   .go-back[_ngcontent-%COMP%]   .left-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px}ion-content[_ngcontent-%COMP%]   .go-back[_ngcontent-%COMP%]   .right-button[_ngcontent-%COMP%]{background:none;border-radius:25px;color:#000}.top-content[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]{border-bottom-left-radius:30px;border-bottom-right-radius:30px;text-align:center;height:350px;padding-top:12vh;background:linear-gradient(to bottom right,#036,#369);color:#fff;margin-bottom:20px}.top-content[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .profile-image[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:10px}.top-content[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .profile-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%}.top-content[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:10px}.top-content[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px}.top-content[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px}.bottom-content[_ngcontent-%COMP%]{height:55vh;padding:0}.bottom-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{--background: transparent !important;background:transparent!important}.bottom-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent !important;background:transparent!important;color:#000;margin:5px;border-bottom:.5px solid #000}.bottom-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0}.bottom-content[_ngcontent-%COMP%]   .icon-row[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;font-size:20px}.bottom-content[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium)}.bottom-content[_ngcontent-%COMP%]   .bottom-button[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:16px}.bottom-content[_ngcontent-%COMP%]   .bottom-button[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 25px}.modal[_ngcontent-%COMP%]{--background: #fff}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{background-color:#fff;padding:30px 20px;box-shadow:0 0 10px #0000000d;text-align:center;height:100%}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#145494;margin-bottom:20px;font-weight:700}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin-bottom:15px;border-radius:10px;--background: #f5f5f5;--border-radius: 10px;color:#000}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input-password-toggle[_ngcontent-%COMP%]{--color: #131416}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .signup-button[_ngcontent-%COMP%]{--background: #145494;font-weight:700;margin-top:20px;border-radius:10px}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .social-login-text[_ngcontent-%COMP%]{margin:20px 0 10px;font-size:14px;color:#7a7a7a}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .social-login[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;font-size:24px;margin:20px 0;color:#145494}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .bottom-text[_ngcontent-%COMP%]{font-size:14px;color:#000}.modal[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .bottom-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#145494;text-decoration:none;font-weight:600}']});let s=l;return s})();export{ze as ProfilePage};
