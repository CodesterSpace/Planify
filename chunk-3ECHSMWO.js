import{a as me}from"./chunk-CUB5A5UJ.js";import"./chunk-MU56VQVL.js";import{Ab as z,Bb as J,Cb as K,Da as F,Db as U,Eb as X,Gb as b,Ha as y,I as s,J as S,L as h,Lb as Y,Ma as A,O as w,Ob as Z,Pb as $,Q as g,Qb as ee,Ta as N,Tb as te,Ua as W,Va as B,W as i,X as t,Xa as L,Xb as ie,Y as d,Ya as O,Za as G,Zb as ne,_a as Q,aa as x,ac as oe,ba as E,bb as R,ca as j,cb as I,cc as re,db as H,ec as le,fc as ae,ia as k,ja as D,ka as T,ma as r,oa as V,pa as _,qa as f,ra as C,vb as M,y as c,z as p,zb as q}from"./chunk-IK3SDQQI.js";import"./chunk-KQYAU5ZY.js";import"./chunk-7KGURMOZ.js";import"./chunk-ZRAG276G.js";import"./chunk-BYYCXTI5.js";import"./chunk-TTTB7IPG.js";import"./chunk-CHHPJ5YN.js";import"./chunk-LZHEG2YN.js";import"./chunk-4U6PRYVA.js";import"./chunk-OAACOBQM.js";import"./chunk-JWIEPCRG.js";import"./chunk-C5RQ2IC2.js";import"./chunk-D4VGNZLR.js";import"./chunk-JHLW7V75.js";import"./chunk-SV7S5NYR.js";import{a as P,b as v}from"./chunk-OLRFWS6T.js";function ce(m,l){if(m&1){let a=x();i(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",19)(3,"ion-button",20),E("click",function(){c(a);let e=j();return p(e.confirm())}),r(4,"Confirm"),t()()()(),i(5,"ion-content",21)(6,"ion-item")(7,"ion-label"),r(8,"Date de d\xE9but"),t(),d(9,"ion-datetime",22),t(),i(10,"ion-item")(11,"ion-label"),r(12,"Date de fin"),t(),d(13,"ion-datetime",23),t()()}m&2&&(s(3),g("strong",!0))}function pe(m,l){if(m&1){let a=x();i(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),r(3),t()(),i(4,"ion-card-content")(5,"ion-item")(6,"ion-input",24),C("ngModelChange",function(e){let n=c(a).$implicit;return f(n.title,e)||(n.title=e),p(e)}),t()(),i(7,"ion-item")(8,"ion-textarea",25),C("ngModelChange",function(e){let n=c(a).$implicit;return f(n.description,e)||(n.description=e),p(e)}),t()(),i(9,"ion-item")(10,"ion-select",26),C("ngModelChange",function(e){let n=c(a).$implicit;return f(n.status,e)||(n.status=e),p(e)}),i(11,"ion-select-option",27),r(12,"Programm\xE9"),t(),i(13,"ion-select-option",28),r(14,"En cours"),t(),i(15,"ion-select-option",29),r(16,"Termin\xE9"),t()()(),i(17,"ion-item")(18,"ion-datetime",30),C("ngModelChange",function(e){let n=c(a).$implicit;return f(n.dueDate,e)||(n.dueDate=e),p(e)}),t()(),i(19,"ion-item")(20,"ion-input",31),C("ngModelChange",function(e){let n=c(a).$implicit;return f(n.assigneeId,e)||(n.assigneeId=e),p(e)}),t()(),i(21,"ion-button",32),E("click",function(){let e=c(a).index,n=j();return p(n.removeStep(e))}),r(22,"Supprimer"),t()()()}if(m&2){let a=l.$implicit,o=l.index;s(3),V("\xC9tape ",o+1,""),s(3),_("ngModel",a.title),s(2),_("ngModel",a.description),s(2),_("ngModel",a.status),s(8),_("ngModel",a.dueDate),s(2),_("ngModel",a.assigneeId)}}var de=(()=>{let l=class l{constructor(o,e,n){this.router=o,this.fb=e,this.projectService=n,this.userid="",this.steps=[],this.projectForm=this.fb.group({title:["",N.required],description:[""],category:[""],priority:["moyen"],startDate:[null],endDate:[null],budget:[0],clientId:[""],location:[""],mainImage:["assets/img/default-project.jpg"]})}ngOnInit(){let o=localStorage.getItem("userid");o&&(this.userid=o,console.log(this.userid))}confirm(){this.modal.dismiss("confirm")}onWillDismiss(o){o.detail.role}addStep(){this.steps.push({s_id:this.generateId(),title:"",description:"",status:"Programm\xE9",dueDate:void 0,assigneeId:""})}removeStep(o){this.steps.splice(o,1)}trackByIndex(o){return o}generateId(){return"_"+Math.random().toString(36).substring(2,9)}slugify(o){return o.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"")}saveProject(){let o=this.projectForm.value,e=new Date().toISOString().slice(0,19),n=v(P({},o),{p_id:this.generateId(),createdAt:e,updatedAt:e,slug:this.slugify(o.title),status:"Programm\xE9",steps:this.steps,team:[{t_m_id:this.userid}],ownerId:this.userid,memberIds:this.userid,tags:[],progress:0,documents:[]});this.projectService.addProject(n).then(u=>{alert("Projet enregistr\xE9 dans Firebase avec succ\xE8s !"),this.router.navigate(["/project/",n.p_id])}).catch(u=>{console.error("Erreur lors de l'ajout du projet :",u),alert("Erreur lors de l'enregistrement.")})}};l.\u0275fac=function(e){return new(e||l)(S(A),S(R),S(me))},l.\u0275cmp=h({type:l,selectors:[["app-add-project-comp"]],viewQuery:function(e,n){if(e&1&&k(M,5),e&2){let u;D(u=T())&&(n.modal=u.first)}},decls:54,vars:4,consts:[[3,"translucent"],[3,"formGroup"],["position","floating"],["formControlName","title"],["formControlName","description"],["formControlName","category"],["formControlName","priority"],["value","faible"],["value","moyen"],["value","important"],["id","open-modal","expand","block"],["trigger","open-modal"],["type","number","formControlName","budget"],["formControlName","clientId"],["formControlName","location"],["formControlName","mainImage"],[4,"ngFor","ngForOf","ngForTrackBy"],["expand","full",3,"click"],["expand","full","color","primary",3,"click"],["slot","end"],[3,"click","strong"],[1,"ion-padding"],["formControlName","startDate","onchange",""],["formControlName","endDate"],["label","Titre","labelPlacement","stacked",3,"ngModelChange","ngModel"],["label","Description","labelPlacement","stacked",3,"ngModelChange","ngModel"],["label","Statut","labelPlacement","stacked",3,"ngModelChange","ngModel"],["value","Programm\xE9"],["value","En cours"],["value","Termin\xE9"],["label","Date limite","labelPlacement","stacked",3,"ngModelChange","ngModel"],["label","Assign\xE9 \xE0 (ID)","labelPlacement","stacked",3,"ngModelChange","ngModel"],["color","danger","expand","block",3,"click"]],template:function(e,n){e&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),r(3,"add-project"),t()()(),i(4,"form",1)(5,"ion-list")(6,"ion-item")(7,"ion-label",2),r(8,"Titre"),t(),d(9,"ion-input",3),t(),i(10,"ion-item")(11,"ion-label",2),r(12,"Description"),t(),d(13,"ion-textarea",4),t(),i(14,"ion-item")(15,"ion-label"),r(16,"Cat\xE9gorie"),t(),d(17,"ion-input",5),t(),i(18,"ion-item")(19,"ion-label"),r(20,"Priorit\xE9"),t(),i(21,"ion-select",6)(22,"ion-select-option",7),r(23,"Basse"),t(),i(24,"ion-select-option",8),r(25,"Moyenne"),t(),i(26,"ion-select-option",9),r(27,"Haute"),t()()(),i(28,"ion-button",10),r(29,"Open"),t(),i(30,"ion-modal",11),w(31,ce,14,1,"ng-template"),t(),i(32,"ion-item")(33,"ion-label"),r(34,"Budget"),t(),d(35,"ion-input",12),t(),i(36,"ion-item")(37,"ion-label"),r(38,"ID Client"),t(),d(39,"ion-input",13),t(),i(40,"ion-item")(41,"ion-label"),r(42,"Lieu"),t(),d(43,"ion-input",14),t(),i(44,"ion-item")(45,"ion-label"),r(46,"Image"),t(),d(47,"ion-input",15),t()()(),i(48,"ion-list"),w(49,pe,23,6,"ion-card",16),t(),i(50,"ion-button",17),E("click",function(){return n.addStep()}),r(51,"Ajouter une \xE9tape"),t(),i(52,"ion-button",18),E("click",function(){return n.saveProject()}),r(53,"Enregistrer le projet"),t()),e&2&&(g("translucent",!0),s(4),g("formGroup",n.projectForm),s(45),g("ngForOf",n.steps)("ngForTrackBy",n.trackByIndex))},dependencies:[y,F,H,O,W,B,G,Q,I,L,Z,$,re,ae,oe,le,te,q,ee,J,U,X,K,z,b,Y,M,ie,ne],encapsulation:2});let m=l;return m})();var Me=(()=>{let l=class l{constructor(){}ngOnInit(){}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=h({type:l,selectors:[["app-add-project"]],decls:2,vars:1,consts:[[3,"fullscreen"]],template:function(e,n){e&1&&(i(0,"ion-content",0),d(1,"app-add-project-comp"),t()),e&2&&g("fullscreen",!0)},dependencies:[b,y,I,de],encapsulation:2});let m=l;return m})();export{Me as AddProjectPage};
